import{b as U,l as A,d as P,e as R,f as c,o as l,i as d,j as p,w as a,k as T,c as e,F as V,x as $,n as j,q as s,y as z,z as g,V as E,s as f,A as I,v as X}from"./index-fef033d9.js";import{c as G,a as v,u as H,d as x,V as w,e as J}from"./index.esm-627548a7.js";import{V as K,a as O,c as Q}from"./VNavigationDrawer-fbdb239f.js";import{a as b,V as W}from"./VContainer-8e961356.js";import{V as Y}from"./VRow-c1a7cdb6.js";const Z=I("h1",null,"登入",-1),le={__name:"LoginView",setup(ee){const{api:_}=$(),h=U(),m=A(),y=P(),{sm:k,xs:S}=R(),B=c(()=>k.value),C=c(()=>S.value),F=c(()=>[{text:"會員專區"},{to:"/register",text:"註冊"},{to:"/login",text:"登入"}]),N=G({account:v().required("帳號為必填欄位").min(6,"使用者帳號長度不符").max(20,"使用者帳號長度不符"),password:v().required("密碼為必填欄位").min(6,"使用者密碼長度不符").max(20,"使用者密碼長度不符")}),{handleSubmit:D,isSubmitting:L}=H({validationSchema:N}),n=x("account"),u=x("password"),q=D(async i=>{var o,t;try{const{data:r}=await _.post("/users/login",{account:i.account,password:i.password});y.login(r.result),m({text:"登入成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),h.push("/")}catch(r){console.log(r);const M=((t=(o=r==null?void 0:r.response)==null?void 0:o.data)==null?void 0:t.message)||"發生錯誤，請稍後再試";m({text:M,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(i,o)=>(l(),d(V,null,[!C.value&&!B.value?(l(),p(K,{key:0,permanent:"true",width:"224"},{default:a(()=>[e(b,null,{default:a(()=>[e(O,{class:"text-center"},{default:a(()=>[(l(!0),d(V,null,j(F.value,t=>(l(),p(W,{key:t,to:t.to},{default:a(()=>[f(X(t.text),1)]),_:2},1032,["to"]))),128))]),_:1})]),_:1})]),_:1})):T("",!0),e(b,null,{default:a(()=>[e(Y,null,{default:a(()=>[e(w,{cols:"12"},{default:a(()=>[Z]),_:1}),e(Q),e(w,{cols:"6",style:{"min-width":"500px"}},{default:a(()=>[e(J,{disabled:s(L),onSubmit:z(s(q),["prevent"])},{default:a(()=>[e(g,{label:"帳號",minlength:"6",maxlength:"20",counter:"",modelValue:s(n).value.value,"onUpdate:modelValue":o[0]||(o[0]=t=>s(n).value.value=t),"error-messages":s(n).errorMessage.value},null,8,["modelValue","error-messages"]),e(g,{label:"密碼",minlength:"6",maxlength:"20",counter:"",type:"password",modelValue:s(u).value.value,"onUpdate:modelValue":o[1]||(o[1]=t=>s(u).value.value=t),"error-messages":s(u).errorMessage.value},null,8,["modelValue","error-messages"]),e(E,{type:"submit",color:"green"},{default:a(()=>[f("登入")]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1})],64))}};export{le as default};
