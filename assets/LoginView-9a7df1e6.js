import{b as U,l as P,d as R,e as T,f as c,o as l,i as d,j as p,w as a,k as $,c as e,F as V,x as j,n as A,q as s,a1 as E,a2 as f,V as I,s as g,a3 as X,v as z}from"./index-fc8543eb.js";import{c as G,a as v,u as H,d as x,V as J}from"./index.esm-f4debaa3.js";import{V as K,a as O,c as Q}from"./VNavigationDrawer-52a1a983.js";import{V as w}from"./VContainer-b6b821c9.js";import{V as W}from"./VRow-3add2272.js";import{V as b}from"./VCol-7877b861.js";import{V as Y}from"./VListItem-40f912dd.js";import"./ssrBoot-170efbf2.js";const Z=X("h1",null,"登入",-1),ie={__name:"LoginView",setup(ee){const{api:_}=j(),h=U(),m=P(),k=R(),{sm:y,xs:S}=T(),B=c(()=>y.value),C=c(()=>S.value),F=c(()=>[{text:"會員專區"},{to:"/register",text:"註冊"},{to:"/login",text:"登入"}]),N=G({account:v().required("帳號為必填欄位").min(6,"使用者帳號長度不符").max(20,"使用者帳號長度不符"),password:v().required("密碼為必填欄位").min(6,"使用者密碼長度不符").max(20,"使用者密碼長度不符")}),{handleSubmit:D,isSubmitting:L}=H({validationSchema:N}),n=x("account"),u=x("password"),q=D(async i=>{var o,t;try{const{data:r}=await _.post("/users/login",{account:i.account,password:i.password});k.login(r.result),m({text:"登入成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),h.push("/")}catch(r){console.log(r);const M=((t=(o=r==null?void 0:r.response)==null?void 0:o.data)==null?void 0:t.message)||"發生錯誤，請稍後再試";m({text:M,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(i,o)=>(l(),d(V,null,[!C.value&&!B.value?(l(),p(K,{key:0,permanent:"true",width:"224"},{default:a(()=>[e(w,null,{default:a(()=>[e(O,{class:"text-center"},{default:a(()=>[(l(!0),d(V,null,A(F.value,t=>(l(),p(Y,{key:t,to:t.to},{default:a(()=>[g(z(t.text),1)]),_:2},1032,["to"]))),128))]),_:1})]),_:1})]),_:1})):$("",!0),e(w,null,{default:a(()=>[e(W,null,{default:a(()=>[e(b,{cols:"12"},{default:a(()=>[Z]),_:1}),e(Q),e(b,{cols:"6",style:{"min-width":"500px"}},{default:a(()=>[e(J,{disabled:s(L),onSubmit:E(s(q),["prevent"])},{default:a(()=>[e(f,{label:"帳號",minlength:"6",maxlength:"20",counter:"",modelValue:s(n).value.value,"onUpdate:modelValue":o[0]||(o[0]=t=>s(n).value.value=t),"error-messages":s(n).errorMessage.value},null,8,["modelValue","error-messages"]),e(f,{label:"密碼",minlength:"6",maxlength:"20",counter:"",type:"password",modelValue:s(u).value.value,"onUpdate:modelValue":o[1]||(o[1]=t=>s(u).value.value=t),"error-messages":s(u).errorMessage.value},null,8,["modelValue","error-messages"]),e(I,{type:"submit",color:"green"},{default:a(()=>[g("登入")]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1})],64))}};export{ie as default};
